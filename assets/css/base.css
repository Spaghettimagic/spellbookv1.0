html,body{height:100%;background:var(--bg);color:var(--text);margin:0}
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif;line-height:var(--lh-b)}
a{color:var(--link);text-decoration:none}
.wrap{max-width:var(--maxw);margin-inline:auto;padding:min(5vw,40px);padding-bottom:calc(96px + var(--safe-b))}
.logo{font-family:"EB Garamond",Garamond,"Times New Roman",serif;font-weight:700;font-size:var(--f-h1);line-height:1.08;margin:0}
.h2{font-size:var(--f-h2)} .h3{font-size:var(--f-h3)}
p,li,code,pre{font-size:var(--f-b)} small{font-size:var(--f-cap);color:var(--muted)}
.meta{color:var(--muted)}
.surface{background:var(--surface);border-radius:var(--r-xl);box-shadow:var(--e2);padding:clamp(12px,2.6vw,24px);border:1px solid var(--border)}
.auto-grid{display:grid;gap:clamp(12px,2.5vw,28px);grid-template-columns:repeat(auto-fit,minmax(min(260px,100%),1fr))}
.auto-grid-sm{display:grid;gap:clamp(10px,2vw,24px);grid-template-columns:repeat(auto-fit,minmax(min(200px,100%),1fr))}
.cluster{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.stack{display:grid;gap:12px}
.center{display:grid;place-items:center}
/* Top bar */
.topbar{position:sticky;top:0;z-index:20;background:color-mix(in oklab,var(--surface),transparent 8%);backdrop-filter:saturate(1.2) blur(6px);border-bottom:1px solid var(--border)}
.topbar-inner{display:flex;gap:10px;align-items:center;justify-content:space-between;padding:10px max(16px,3vw)}
.brand{display:flex;align-items:center;gap:10px}
.brand .wordmark{font-weight:800;letter-spacing:.5px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.nav-actions{display:flex;gap:8px;align-items:center}
.burger{display:none}
@media (max-width: 768px){ 
  .nav-actions{display:none} 
  .burger{display:inline-flex}
  .topbar-inner{padding:8px max(12px,2vw)}
  .brand .wordmark{max-width:min(70vw,240px)} 
}
/* Drawer */
.drawer{position:fixed;inset:0 0 0 auto;width:min(360px,92vw);transform:translateX(100%);transition:transform var(--dur-drawer) var(--ease);background:var(--surface);border-left:1px solid var(--border);box-shadow:var(--e4);padding:20px;z-index:30;overflow-y:auto;padding-bottom:calc(20px + var(--safe-b) + 70px)}
.drawer.show{transform:translateX(0)}
.drawer .btn-ghost{padding:14px 16px}
/* Bottom nav */
.bottombar{position:fixed;bottom:0;left:0;right:0;background:var(--surface-2);border-top:1px solid var(--border);display:grid;grid-template-columns:repeat(5,1fr);padding:0;border-radius:20px 20px 0 0;box-shadow:0 -8px 16px rgba(0,0,0,.25);z-index:50}
.bottombar a{display:flex;flex-direction:column;align-items:center;gap:4px;padding:12px 6px;padding-bottom:calc(12px + var(--safe-b));text-align:center}
.bottombar .icon{width:24px;height:24px;color:var(--text);opacity:.92}
.bottombar a[aria-current="page"]{background:color-mix(in oklab,var(--accent),transparent 90%)}
.bottombar a:active{background:color-mix(in oklab,var(--accent),transparent 85%)}
@media (max-width:380px){ .bottombar small{font-size:10px} }
@media (max-width:340px){ .bottombar small{display:none} }

/* Layout + sidebar on desktop */
.layout{display:block}
@media (min-width:768px){
  .layout{display:flex;align-items:flex-start}
  .layout .drawer{position:sticky;top:0;transform:none;width:260px;border-left:none;border-right:1px solid var(--border);box-shadow:none;height:100vh;padding-bottom:20px}
  .layout main{flex:1}
  .wrap{padding-bottom:40px}
  #closeDrawer{display:none}
  .bottombar{display:none}
}
/* Buttons */
.btn{appearance:none;border:none;padding:12px 16px;border-radius:var(--r-pill);font-weight:700;cursor:pointer;transition:background var(--dur-hover) var(--ease),transform var(--dur-press) var(--ease),box-shadow var(--dur-hover) var(--ease);white-space:nowrap;touch-action:manipulation}
.btn:active{transform:translateY(1px)}
.btn-primary{background:var(--accent);color:var(--bg);box-shadow:var(--e1)} .btn-primary:hover{filter:brightness(.92)}
.btn-secondary{background:transparent;color:var(--accent);border:var(--bw-2) solid var(--accent)} .btn-secondary:hover{background:color-mix(in oklab, var(--accent), transparent 85%)}
.btn-ghost{background:transparent;color:var(--accent)}
@media (max-width: 480px){
  .btn{min-height:44px;padding:12px 14px;font-size:15px}
  .cluster .btn{flex-grow:1}
}
/* Inputs */
.field{display:grid;gap:6px} .label{color:var(--muted);font-weight:600;font-size:12px}
.input, select, textarea{width:100%;color:var(--text);background:var(--surface-2);border:var(--bw-2) solid var(--border);border-radius:var(--r-m);padding:12px;min-height:48px;font-size:16px}
.input:hover, select:hover, textarea:hover{border-color:var(--accent)}
.input:focus, select:focus, textarea:focus, .btn:focus{outline:none;box-shadow:0 0 0 2px var(--text), 0 0 0 4px var(--accent);border-color:var(--accent)}
@media (max-width: 480px){
  .field{margin-bottom:8px}
  .input, select, textarea{font-size:16px;padding:14px 12px;min-height:52px}
  input[type="search"], input[type="text"], input[type="number"]{-webkit-appearance:none}
}
/* Card + CQ */
.card{display:grid;gap:10px;border:1px solid var(--accent);border-radius:var(--r-l);background:var(--bg);padding:12px;container-type:inline-size}
.card h4{font-family:"EB Garamond",serif;margin:0;font-size:20px}
@container (min-width: 520px){ .card{grid-template-columns:72px 1fr auto;align-items:center} .card .meta{grid-column:2/span 1} }
/* Tabs */
.tabs{display:flex;gap:8px;flex-wrap:wrap}
.tab{padding:8px 12px;border-radius:var(--r-pill);border:1px solid var(--border);background:var(--surface-2);cursor:pointer}
.tab[aria-selected="true"]{border-color:var(--accent);box-shadow:0 0 0 2px color-mix(in oklab,var(--accent),transparent 70%)}
/* Table */
.table{width:100%;border-collapse:collapse;display:block;overflow-x:auto;-webkit-overflow-scrolling:touch;max-width:100%}
.table table{width:100%;min-width:400px}
.table th,.table td{border:1px solid var(--border);padding:10px 12px;text-align:left;white-space:nowrap}
.table thead th{background:color-mix(in oklab,var(--surface),black 6%)}
@media (max-width: 580px){
  .table{margin:0 -10px;width:calc(100% + 20px);border-radius:0}
  .table th,.table td{padding:8px 10px;font-size:14px}
}
/* Responsive data cards alternative to tables */
@media (max-width: 480px){
  .responsive-table{border:0}
  .responsive-table table, .responsive-table thead, .responsive-table tbody, .responsive-table th, .responsive-table td, .responsive-table tr{display:block;width:100%}
  .responsive-table thead{position:absolute;left:-9999px;top:-9999px}
  .responsive-table tr{margin-bottom:12px;border:1px solid var(--border);border-radius:var(--r-l);overflow:hidden}
  .responsive-table td{padding:10px;position:relative;text-align:right;border:none;border-bottom:1px solid var(--border)}
  .responsive-table td:last-child{border-bottom:0}
  .responsive-table td:before{content:attr(data-label);position:absolute;left:10px;top:10px;font-weight:600;text-align:left}
}
/* DnD */
.drop{border:2px dashed var(--border);border-radius:14px;padding:12px;min-height:160px;touch-action:none}
.drop .item{background:var(--surface-2);border:1px solid var(--border);border-radius:10px;padding:10px 12px;display:flex;align-items:center;gap:10px;margin:8px 0;cursor:grab;user-select:none;-webkit-user-select:none;touch-action:none}
.drop .item:active{cursor:grabbing}
.drop .item.dragging{opacity:.7;box-shadow:var(--e2)}
.placeholder{height:44px;border:2px dashed var(--accent);border-radius:10px;margin:8px 0}
@media (max-width: 768px){
  .drop .item{padding:14px;min-height:54px}
  .drop .item:before{content:'â‰¡';display:inline-block;margin-right:6px;opacity:0.7;font-size:18px}
}
/* Assistive controls */
.kb-controls{display:flex;gap:8px;margin:6px 0}
.kb-controls button{padding:10px 14px;border-radius:var(--r-m);min-width:44px;min-height:44px}
.skip-link{position:absolute;top:-100px;left:0;padding:10px;background:var(--accent);color:var(--bg);z-index:100;transition:top .3s}
.skip-link:focus{top:0;outline:none}
[tabindex]:focus-visible,a:focus-visible,button:focus-visible,input:focus-visible,select:focus-visible,textarea:focus-visible{outline:2px solid var(--accent);outline-offset:2px}
/* Chips */
.chip{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:var(--r-pill);border:1px solid var(--border);background:var(--surface-2)}
/* Theme selector */
.theme-selector{display:flex;align-items:center;gap:6px}
.theme-selector button{width:40px;height:40px;border-radius:50%;overflow:hidden;padding:0;position:relative;border:2px solid transparent}
.theme-selector button[aria-pressed="true"]{border-color:var(--accent)}
.theme-selector button::after{content:"";position:absolute;inset:0;border-radius:50%}
.theme-selector button[data-theme="dark"]::after{background:linear-gradient(135deg, #1C1E3A 50%, #0B0B0D 50%)}
.theme-selector button[data-theme="light"]::after{background:linear-gradient(135deg, #FFFFFF 50%, #F6F3EC 50%)}
.theme-selector button[data-theme="hc"]::after{background:linear-gradient(135deg, #000 50%, #FFF 50%);box-shadow:inset 0 0 0 2px #000}
.color-option{width:36px;height:36px;border-radius:50%;border:2px solid transparent;padding:0;cursor:pointer}
.color-option[aria-pressed="true"]{border-color:var(--text);box-shadow:0 0 0 2px var(--surface-2)}
@media (max-width: 480px){
  .theme-selector button, .color-option{width:36px;height:36px}
}
/* Search Suggestions */
.search-suggestions{position:absolute;margin:0;padding:0;list-style:none;background:var(--surface);border:1px solid var(--border);border-radius:var(--r-m);box-shadow:var(--e3);z-index:60;max-height:240px;overflow-y:auto;-webkit-overflow-scrolling:touch}
.search-suggestions li{padding:12px 16px;cursor:pointer;transition:background 0.15s ease}
.search-suggestions li:hover,.search-suggestions li.selected{background:color-mix(in oklab,var(--accent),transparent 85%)}
.search-suggestions.hidden{display:none}
mark{background:color-mix(in oklab,var(--accent),transparent 70%);color:inherit;padding:0 2px}
/* Advanced Search */
.search-panel{background:var(--surface-2);border-radius:var(--r-l);padding:16px;margin-bottom:20px}
.search-filters{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px;align-items:center}
.search-filters .field{flex:1;min-width:180px;margin:0}
.search-filters .btn{margin-top:22px}
.search-count{color:var(--muted);font-size:14px;margin-top:8px}
@media (max-width: 480px){
  .search-filters{gap:8px}
  .search-filters .field{min-width:140px}
}
/* Utilities */
.clamp-1{display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden}
.clamp-2{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.clamp-3{display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}
.hidden{display:none!important}
.icon{width:24px;height:24px;flex-shrink:0}
img, svg, video{max-width:100%;height:auto;display:block}
/* Print */
@media print{.topbar,.bottombar,.drawer{display:none!important};body{color:#111;background:#fff}}
